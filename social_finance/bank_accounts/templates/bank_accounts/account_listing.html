{% extends 'social_finance/base.html' %}

{% block title %}
	{{ block.super }} - Accounts
{% endblock %}

{% block content %}
	<div class="container">
		<h1>Customers
			<a class="pull-right btn btn-success" href="{% url 'bank-user-create' %}"><span class="glyphicon glyphicon-plus"></span> Add Customer</a>
		</h1>
			{% for user in users %}
				<div class="panel-group">
				  <div class="panel panel-default">
				    <div class="panel-heading">
				      <h4 class="panel-title">
				      	<a class="glyphicon glyphicon-pencil" href="{% url 'bank-user-update' user.id %}"></a> &nbsp;
				        <a data-toggle="collapse" href="#accountPanel{{user.id}}">{{user.firstname}} {{user.lastname}} ({{user.accounts.all|length}})</a>
				        <a class="pull-right glyphicon glyphicon-remove" href="{% url 'bank-user-delete' user.id %}"></a>
				      </h4>
				    </div>
				    <div id="accountPanel{{user.id}}" class="panel-collapse collapse">
				      {% if user.accounts.all|length %}
						<table class="table table-hover">
							<thead>
								<tr>
									<th>Account No</th>
									<th>IBAN</th>
									<th><a class="glyphicon glyphicon-plus" href="{% url 'bank-account-create' user.id %}"></a></th>
								</tr>
							</thead>

							<tbody>
								{% for account in user.accounts.all %}
									<tr>
										<td>{{ account.id }}</td>
										<td>
											{{ account.iban }} <a class="glyphicon glyphicon-pencil" href="{% url 'bank-account-update' user.id account.id %}"></a>
										</td>
										<td>
											<a class="glyphicon glyphicon-remove" href="{% url 'bank-account-delete' user.id account.id %}"></a>
										</td>
									</tr>
				      			{% endfor %}
							</tbody>
						</table>	
				      {% else %}
				      	<div class="alert alert-info">
					      	There are no Accounts available yet.
					      		<a class="btn btn-success" href="{% url 'bank-account-create' user.id %}"><span class="glyphicon glyphicon-plus"></span> Add account</a>
					     </div>
				      {% endif %}
				    </div>
				  </div>
				</div>
			{% endfor %}
	</div>
{% endblock %}